<link rel="import" href="../../../../../../../packages/polymer/polymer.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_overlay.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_header_panel.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_drawer_panel.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_menu.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_item.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_toolbar.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_pages.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_overlay.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/inbox_list/inbox_list.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/add_stuff/add_stuff.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/dialog/welcome/welcome.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/dialog/sign_in/sign_in.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/item_preview/item_preview.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/item_activities/item_activities.html">
<link rel="import" href="../../../../../../../packages/woven/src/client/components/my_element/my_element.html">
<link rel="import" href="../../../../../../../packages/paper_elements/paper_toast.html">
<link rel="import" href="../../../../../../../packages/core_elements/core_transition_css.html">
<!--<link rel="import" href="../../../../../../../packages/core_elements/core_animated_pages.html">-->
<!--<link rel="import" href="../../../../../../../packages/core_elements/src/core-animated-pages/transitions/slide-from-right.html">-->
<!--<link rel="import" href="../../../../../../../packages/core_elements/src/core-animated-pages/transitions/cross-fade.html">-->

<polymer-element name="woven-app">
  <template>
    <link rel="stylesheet" href="woven_app.css">
    <core-drawer-panel responsiveWidth="{{responsiveWidth}}">

      <div vertical layout drawer>
        <core-header-panel id="side-panel" navigation flex mode="seamed">
          <core-toolbar id="toolbar-drawer" class="toolbar">
            <span data-page="0" data-url="/" on-tap="{{switchPage}}">The LAB Collective</span>
          </core-toolbar>
          <core-menu selected="Everything" valueattr="label" selectedindex="0" id="core_menu" theme="core-light-theme">
            <core-item data-page="0" data-url="/" label="Everything" icon="list" id="core_item" horizontal center layout class="item" active on-click="{{switchPage}}"></core-item>
            <core-item data-page="2" data-url="/starred" label="Starred" icon="star" id="core_item" horizontal center layout class="item" on-click="{{switchPage}}"></core-item>

            <div id="button-area">
              <template if="{{app.user == null}}">
                <p id="message"></p>
                <button class="signin-btn" id="facebook-signin" on-click="{{signInWithFacebook}}">Sign in with Facebook</button>
              </template>

              <template if="{{app.user != null}}">
                <p>Hello, {{app.user.username}}!</p>
                <button class="signin-btn" id="facebook-signin" on-click="{{signOut}}">Sign out</button>
              </template>

              <!--<template if="{{app.router.route.pattern == '/starred'}}">-->
              <!--<p>We are on Starred page!</p>-->
              <!--</template>-->
            </div>

          </core-menu>
        </core-header-panel>

      </div>

      <core-header-panel id="main-panel" main mode="seamed">

        <core-toolbar id="toolbar-main">
          <core-icon-button class="btn primary" id="menu-button" icon="menu" on-tap="{{togglePanel}}"></core-icon-button>
          <span id="page-title" flex></span>
          <template if="{{app.user != null}}">
            <core-icon-button class="btn primary" id="add-button" icon="create" on-tap="{{toggleAddStuff}}"></core-icon-button>
          </template>
          <template if="{{app.user == null}}">
            <core-icon-button class="btn primary" id="add-button" icon="create" on-tap="{{toggleSignIn}}"></core-icon-button>
          </template>
        </core-toolbar>

        <div class="content">
          <core-animated-pages id="pages" selected="{{app.selectedPage}}">
            <section>
              <template if="{{app.selectedPage === 0}}">
                <div cross-fade="{{app.selectedPage === 0}}">
                  <inbox-list id="inbox-list" app="{{app}}"></inbox-list>
                </div>
              </template>
            </section>
            <section layout vertical>
              <template if="{{app.selectedPage === 1}}">
                <div class="page-content">
                  <item-preview id="item-preview" app="{{app}}"></item-preview>
                  <item-activities app="{{app}}"></item-activities>
                </div>
              </template>
            </section>
            <section layout vertical>
              <template if="{{app.selectedPage === 2}}">
                <div class="page-content">
                  <h1>Starred page is coming soon.</h1>
                </div>
              </template>
            </section>
          </core-animated-pages>
        </div>

      </core-header-panel>

    </core-drawer-panel>
    <template if="{{app.user != null}}">
      <add-stuff app="{{app}}"></add-stuff>
    </template>
    <template if="{{app.user == null}}">
      <!--<sign-in app="{{app}}"></sign-in>-->
      <core-overlay id="sign-in-overlay" class="sign-in-overlay" layered backdrop opened="false" transition="core-transition-center">
        <span id="message">Please sign in to comment.</span>
        <button class="signin-btn" id="facebook-signin" on-click="{{signInWithFacebook}}">Sign in with Facebook</button>
      </core-overlay>
    </template>
    <paper-toast id="toast-message" duration="4000"></paper-toast>
    <template if="{{app.router.route.pattern == '/welcome' && app.user != null}}">
      <welcome-dialog app="{{app}}"></welcome-dialog>
    </template>
  </template>
  <script type="application/dart" src="woven_app.dart"></script>
</polymer-element>
